import sys
import numpy as np

sys.path.insert(0, '/mnt/PhD/functions/algorithms')
sys.path.insert(0, '/mnt/PhD/functions/parsing')

from localmax import take_points
from parsing import readpds
from clean_values import clean_image

def main(route1):
    #route1 = 'data/W20150511T084324763ID30F18.IMG'
    route2 = 'cache2' + str(route1[4:31]) + '.txt'

    image = readpds(route1)
    image = clean_image(image)
    print ('Image clean from nan values and charged in memory as', type(image[0]) )
    count = image[1]
    image = image[0]

    print ('number of nan values found = ', count)
    print ('##############           Module clean_image executed                       #####################')
    stars = take_points(image)
    print ('estrellitas obtenidas', type(stars), len(stars)/2)
    print ('##############           Module take_points executed                       #####################')
    fichero = open(route2,'w')
    for i in range (0, (int(len(stars)/2-1))):
        fichero.write(str(stars[2*i]))
        fichero.write(str( ','))
        fichero.write(str(stars[2 * i + 1]))
        fichero.write('\n')


    fichero.close()

main('data/W20150511T083550851ID30F18.IMG')
main('data/W20150511T083724738ID30F18.IMG')
main('data/W20150511T083850857ID30F18.IMG')
main('data/W20150511T083957805ID30F18.IMG')
main('data/W20150511T084024751ID30F18.IMG')
main('data/W20150511T084150874ID30F18.IMG')
main('data/W20150511T084257821ID30F18.IMG')
main('data/W20150511T084324763ID30F18.IMG')
main('data/W20150511T084450888ID30F18.IMG')
main('data/W20150511T084557832ID30F18.IMG')
main('data/W20150511T084624780ID30F18.IMG')
main('data/W20150511T084750868ID30F18.IMG')
main('data/W20150511T084857815ID30F18.IMG')
main('data/W20150511T084924759ID30F18.IMG')
main('data/W20150511T085050908ID30F18.IMG')
main('data/W20150511T085157853ID30F18.IMG')
main('data/W20150511T085224807ID30F18.IMG')
main('data/W20150511T085350904ID30F18.IMG')
main('data/W20150511T085457853ID30F18.IMG')
main('data/W20150511T085524797ID30F18.IMG')
main('data/W20150511T085650903ID30F18.IMG')
main('data/W20150511T085757849ID30F18.IMG')
main('data/W20150511T085824796ID30F18.IMG')
main('data/W20150511T085950900ID30F18.IMG')
main('data/W20150511T090057848ID30F18.IMG')
main('data/W20150511T090124794ID30F18.IMG')
main('data/W20150511T090250899ID30F18.IMG')
main('data/W20150511T090357846ID30F18.IMG')
main('data/W20150511T090424795ID30F18.IMG')
main('data/W20150511T090551775ID30F18.IMG')
main('data/W20150511T090658724ID30F18.IMG')
main('data/W20150511T090725670ID30F18.IMG')
main('data/W20150511T090851750ID30F18.IMG')
main('data/W20150511T091002986ID30F18.IMG')
main('data/W20150511T091038427ID30F18.IMG')
main('data/W20150511T091151803ID30F18.IMG')
main('data/W20150511T091307248ID30F18.IMG')
main('data/W20150511T091342704ID30F18.IMG')
main('data/W20150511T091451774ID30F18.IMG')
main('data/W20150511T091607215ID30F18.IMG')
main('data/W20150511T091642875ID30F18.IMG')
main('data/W20150511T091751776ID30F18.IMG')
main('data/W20150511T091858731ID30F18.IMG')
main('data/W20150511T091925683ID30F18.IMG')
main('data/W20150511T092051768ID30F18.IMG')
main('data/W20150511T092158719ID30F18.IMG')
main('data/W20150511T092234165ID30F18.IMG')
main('data/W20150511T092351808ID30F18.IMG')
main('data/W20150511T092458762ID30F18.IMG')
main('data/W20150511T092525713ID30F18.IMG')
main('data/W20150511T092651787ID30F18.IMG')
main('data/W20150511T092758737ID30F18.IMG')
main('data/W20150511T092825690ID30F18.IMG')
main('data/W20150511T092951803ID30F18.IMG')
main('data/W20150511T093107250ID30F18.IMG')
main('data/W20150511T093134417ID30F18.IMG')
main('data/W20150511T093251813ID30F18.IMG')
main('data/W20150511T093407256ID30F18.IMG')
main('data/W20150511T093442917ID30F18.IMG')
main('data/W20150511T093550758ID30F18.IMG')
main('data/W20150511T093657715ID30F18.IMG')
main('data/W20150511T093733157ID30F18.IMG')
main('data/W20150511T093850763ID30F18.IMG')
main('data/W20150511T094006209ID30F18.IMG')
main('data/W20150511T094041650ID30F18.IMG')
main('data/W20150511T094150780ID30F18.IMG')
main('data/W20150511T094257744ID30F18.IMG')
main('data/W20150511T094324715ID30F18.IMG')
main('data/W20150511T094450776ID30F18.IMG')
main('data/W20150511T094606218ID30F18.IMG')
main('data/W20150511T094641657ID30F18.IMG')
main('data/W20150511T094750792ID30F18.IMG')
main('data/W20150511T094906239ID30F18.IMG')
main('data/W20150511T094941901ID30F18.IMG')
main('data/W20150511T095050777ID30F18.IMG')
main('data/W20150511T095206227ID30F18.IMG')
main('data/W20150511T095233182ID30F18.IMG')
main('data/W20150511T095350821ID30F18.IMG')
main('data/W20150511T095506260ID30F18.IMG')
main('data/W20150511T095541701ID30F18.IMG')
main('data/W20150511T095650801ID30F18.IMG')
main('data/W20150511T095806245ID30F18.IMG')
main('data/W20150511T095841907ID30F18.IMG')
main('data/W20150511T095950816ID30F18.IMG')
main('data/W20150511T100057773ID30F18.IMG')
main('data/W20150511T100133216ID30F18.IMG')
main('data/W20150511T100250837ID30F18.IMG')
main('data/W20150511T100357791ID30F18.IMG')
main('data/W20150511T100424749ID30F18.IMG')

